//components/MdxComponents.tsx/*eslint-disable@next/next/no-img-element*/import * as React from "react";import Linkfrom"next/link";import Image,{ImageProps}from "next/image";/*------------------------------*Utilities*------------------------------*/function slugify(str:string){return(str||"").toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");}function isExternal(href:string){return/^https?:\/\//i.test(href)&&!href.includes(process.env.NEXT_PUBLIC_SITE_URL??"");}/*------------------------------*SmartLink*------------------------------*/type AProps=React.ComponentPropsWithoutRef<"a">&{href?:string};function SmartLink({href="",children,...props}:AProps){if(!href)return<a{...props}>{children}</a>;//Mailto/Telpassthroughif(/^(mailto:|tel:)/.test(href))return<a href={href}{...props}>{children}</a>;//Externallinksif(isExternal(href)){return(<a href={href}target="_blank"rel="noopenernoreferrer"{...props}>{children}</a>);}//InternallinksviaNext.jsreturn(<Link href={href}legacyBehavior><a{...props}>{children}</a></Link>);}/*------------------------------*SmartImage*------------------------------*/type SmartImageProps=Omit<ImageProps,"src"|"alt">&{src?:string;alt?:string;};function SmartImage({src="",alt="",sizes="100vw",...rest}:SmartImageProps){if(!src)returnnull;constisLocal=src.startsWith("/")||(!/^https?:\/\//i.test(src)&&!!src);if(isLocal){return(<Image src={src}alt={alt}width={(restasany).width??1600}height={(restasany).height??900}sizes={sizes}priority={Boolean((restasany).priority)}style={{height:"auto",width:"100%",...(restasany).style}}{...rest}/>);}//Remoteimagefallback:plain<img>//@ts-ignoreallowdecodingon<img>return(<img src={src}alt={alt}decoding="async"loading="lazy"style={{maxWidth:"100%",height:"auto"}}{...(restasany)}/>);}/*------------------------------*CodeBlockwithcopybutton*------------------------------*/function CopyButton({getText}:{getText:()=>string}){const[copied,setCopied]=React.useState(false);return(<buttontype="button"onClick={async()=>{try{awaitnavigator.clipboard.writeText(getText());setCopied(true);setTimeout(()=>setCopied(false),1500);}catch{//no-op}}}className="absoluteright-2top-2rounded-mdborderborder-lightGreypx-2py-1text-xstext-gray-700hover:bg-gray-50"aria-label="Copycode">{copied?"Copied":"Copy"}</button>);}type PreProps=React.ComponentPropsWithoutRef<"pre">&{"data-language"?:string};function Pre({children,...props}:PreProps){constcodeRef=React.useRef<HTMLElement|null>(null);constgetText=()=>(codeRef.current?.textContent??"").trim();return(<div className="relativemy-6overflow-hiddenrounded-lgborderborder-lightGrey"><CopyButtongetText={getText}/><pre className="overflow-x-autop-4text-smleading-relaxed"{...props}>{React.Children.map(childrenasany,(child)=>{if(React.isValidElement(child)&&child.type==="code"){returnReact.cloneElement(childasany,{ref:codeRef});}returnchild;})}</pre></div>);}function Code(props:React.ComponentPropsWithoutRef<"code">){return<code{...props}/>;}/*------------------------------*Headingswithanchors*------------------------------*/type HeadingProps=React.ComponentPropsWithoutRef<"h1">;function makeHeading(Tag:"h1"|"h2"|"h3"|"h4"){constHeading=({children,id,...props}:HeadingProps)=>{consttext=React.Children.toArray(children).join("");constanchor=id||slugify(String(text));return(<Tagi d={anchor}{...props}><a href={`#${anchor}`}className="no-underlinehover:underlinedecoration-muted-gold/60">{children}</a></Tag>);};Heading.displayName=`MDXHeading(${Tag.toUpperCase()})`;returnHeading;}constH1=makeHeading("h1");constH2=makeHeading("h2");constH3=makeHeading("h3");constH4=makeHeading("h4");/*------------------------------*Tables/Blockquote*------------------------------*/function TableWrapper(props:React.ComponentPropsWithoutRef<"table">){return(<div className="my-6overflow-x-autorounded-lgborderborder-lightGrey"><table className="w-fullmin-w-maxtext-left"{...props}/></div>);}TableWrapper.displayName="MDXTableWrapper";function Blockquote(props:React.ComponentPropsWithoutRef<"blockquote">){return(<blockquote className="my-6border-l-4pl-4italic"style={{borderLeftColor:"var(--color-accent)"}}{...props}/>);}Blockquote.displayName="MDXBlockquote";/*------------------------------*Callout*------------------------------*/type CalloutProps={type?:"info"|"success"|"warning"|"danger";title?:string;children?:React.ReactNode;};consttone={info:{bg:"#EFF6FF",border:"#93C5FD",title:"#1E3A8A"},success:{bg:"#ECFDF5",border:"#6EE7B7",title:"#065F46"},warning:{bg:"#FFFBEB",border:"#FCD34D",title:"#92400E"},danger:{bg:"#FEF2F2",border:"#FCA5A5",title:"#991B1B"},};function Callout({type="info",title,children}:CalloutProps){constc=(toneasany)[type]??tone.info;return(<div className="my-6rounded-lgborderp-4"style={{background:c.bg,borderColor:c.border}}role="note">{title&&(<div className="mb-1font-semibold"style={{color:c.title}}>{title}</div>)}<div className="[&>p]:m-0[&>p+*]:mt-3">{children}</div></div>);}Callout.displayName="MDXCallout";/*------------------------------*YouTube*------------------------------*/function YouTube({id,title}:{id:string;title?:string}){if(!id)returnnull;const src=`https://www.youtube-nocookie.com/embed/${encodeURIComponent(id)}`;return(<div className="my-6aspect-videow-fulloverflow-hiddenrounded-lgborderborder-lightGrey"><iframe src={src}title={title??"YouTubevideo"}allow="accelerometer;clipboard-write;encrypted-media;gyroscope;picture-in-picture;web-share"allowFullScreenreferrerPolicy="no-referrer-when-downgrade"loading="lazy"className="h-fullw-full"/></div>);}YouTube.displayName="MDXYouTube";/*------------------------------*Figurehelpers(namedtosatisfydisplay-name)*------------------------------*/function Figure(props:React.ComponentPropsWithoutRef<"figure">){return<figure className="my-6"{...props}/>;}Figure.displayName="MDXFigure";function Figcaption(props:React.ComponentPropsWithoutRef<"figcaption">){return<figcaption className="mt-2text-smtext-gray-600"{...props}/>;}Figcaption.displayName="MDXFigcaption";/*------------------------------*MDXComponentsMap*------------------------------*/export constmdxComponents={//HTMLelementoverridesa:SmartLink,img:SmartImage,pre:Pre,code:Code,h1:H1,h2:H2,h3:H3,h4:H4,table:TableWrapper,blockquote:Blockquote,//CustomshortcodesCallout,YouTube,//HelpersFigure,Figcaption,};export type MdxComponents=typeofmdxComponents;//export undermultiplenamessopagescanimporthowevertheylike.export constcomponents=mdxComponents;export defaultmdxComponents;

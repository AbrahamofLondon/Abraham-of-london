//components/homepage/HeroBanner.tsx"useclient";//ExplicitlymarkingasClientComponent,asitusesHooksimport*asReactfrom"react";import clsxfrom"clsx";import Imagefrom"next/image";//---type Definitions---type VideoSource={src:string;type:"video/webm"|"video/mp4";/**Optionalmediaqueryforconditionalloading(e.g.,mobilevideo)*/media?:string;};type Props={poster:string;videoSources?:ReadonlyArray<VideoSource>|null;/**Acceptsnull;willbenormalized*/heightClassName?:string|null;/**Tailwindclassforobject-position(e.g.,'object-top','object-center')*/mobileObjectPositionClass?:string;/**Contenttodisplayoverthebanner(e.g.,title,CTA)*/overlay?:React.ReactNode;className?:string;};//---Component---export defaultfunctionHeroBanner({poster,videoSources,heightClassName,mobileObjectPositi onClass="object-center",overlay,className,}:Props){constvideoRef=React.useRef<HTMLVideoElement|null>(null);//SafelycoercevideoSourcesintoanarrayconstsources:ReadonlyArray<VideoSource>=Array.isArray(videoSources)?videoSources:[];consthasVideo=sources.length>0;//UsemoremodernandreliableviewportunitsconstnormalizedHeight=heightClassName??"min-h-[70dvh]sm:min-h-[72dvh]lg:min-h-[78lvh]";//---ReducedMotionandPlaybackLogic---React.useEffect(()=>{constv=videoRef.current;if(!v||typeofwindow==='undefined'||!("matchMedia"inwindow))return;constmql=window.matchMedia("(prefers-reduced-motion:reduce)");consthandlePlayback=()=>{//Ifreducedmotionispreferred,ensurevideoispausedif(mql.matches){v.pause();return;}//Attempttoplay,catchingthecommon"play()failed"exceptionv.play().catch(error=>{//console.error("Videoautoplayfailed:",error);});};//InitialcheckandsetuplistenerhandlePlayback();mql.addEventListener("change",handlePlayback);//Cleanuplisteneroncomponentunmountreturn()=>mql.removeEventListener("change",handlePlayback);},[hasVideo]);//Onlyre-runifvideopresencechanges//---ImageFallbackProps---constimageProps={src:poster,//Fix:Explicitlyensurethealtpropispresentalt:"Decorative,high-impactbackgroundimageforthemainherosection",className:clsx("h-fullw-fullobject-cover",mobileObjectPositionClass),fill:trueasconst,sizes:"100vw",priority:trueasconst,//EssentialforLCPoptimization};return(<section//Use role="banner"forsemanticmeaninginherosections role="banner"className={clsx("relativeisolatew-fulloverflow-hiddenbg-black",normalizedHeight,className)}>{hasVideo?(//---VideoComponent---<videoref={videoRef}className={clsx("absoluteinset-0h-fullw-fullobject-cover",mobileObjectPositionClass)}poster={poster}autoPlaymutedloopplaysInlinepreloa d="metadata"aria-hidden="true"//Videoisdecorative/background onContextMenu={(e)=>e.preventDefault()}>{sources.map((s,i)=>(<sourcekey={i}src={s.src}type={s.type}{...(s.media?{media:s.media}:{})}/>))}{/*Fallback:ifvideofailscompletely,theposterimagedefinedbelowwillshow*/}</video>):(//---ImageFallbackComponent(NoVideo)---//eslint-disable-next-linejsx-a11y/alt-text<Image{...imageProps}/>)}{/*Subtletop/bottomgradientforlegibility(Overlay)*/}<div aria-hidden="true"className="pointer-events-noneabsoluteinset-0bg-[linear-gradient(to_bottom,rgba(0,0,0,.35),transparent_40%,transparent_70%,rgba(0,0,0,.25))]"/>{/*Overlaycontent(heading/CTA)*/}{overlay?(<div className="relativez-[1]mx-autoflexh-fullmax-w-7xlitems-endpx-4pb-10"><div className="text-creamdrop-shadow-[0_1px_10px_rgba(0,0,0,.35)]">{overlay}</div></div>):null}{/*Noscriptfallbackforposter(essentialfornon-JS/server-siderendering)*/}<noscript>{/*eslint-disable-next-line@next/next/no-img-element*/}<img alt="Decorativefallbackimageforherosection."src={poster}className={clsx("absoluteinset-0h-fullw-fullobject-cover",mobileObjectPositionClass)}loading="lazy"/></noscript></section>);}

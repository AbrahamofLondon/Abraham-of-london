import*asReactfrom"react";importHeadfrom"next/head";importLayoutfrom"@/components/Layout";import{subscribe}from"@/lib/subscribe";typeStatus=|{state:"idle"}|{state:"loading"}|{state:"success";message:string}|{state:"error";message:string};constEMAIL_RE=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;exportdefaultfunctionNewsletterPage(){const[email,setEmail]=React.useState("");const[status,setStatus]=React.useState<Status>({state:"idle"});asyncfunctiononSubmit(e:React.FormEvent){e.preventDefault();consttrimmed=email.trim().toLowerCase();if(!EMAIL_RE.test(trimmed)){setStatus({state:"error",message:"Pleaseenteravalidemailaddress."});return;}setStatus({state:"loading"});try{constres=awaitsubscribe(trimmed);if(res.ok){setStatus({state:"success",message:res.message||"You'resubscribed.Welcome!"});setEmail("");}else{setStatus({state:"error",message:res.message||"Somethingwentwrong.Pleasetryagain."});}}catch{setStatus({state:"error",message:"Networkerror.Pleasetryagain."});}}constmessage=status.state==="success"||status.state==="error"?String(status.message):"";return(<LayoutpageTitle="Newsletter"hideCTA><Head><metaname="description"content="SubscribetoAbrahamofLondonupdatesandessays."/></Head><sectionclassName="bg-white"><divclassName="mx-automax-w-3xlpx-4py-16"><headerclassName="mb-6text-center"><h1className="font-seriftext-4xlfont-semiboldtext-deepCharcoal">JointheNewsletter</h1><pclassName="mt-2text-smtext-[color:var(--color-on-secondary)/0.7]">Essays,eventinvitations,andprojectupdates.Nospam—ever.</p></header><formonSubmit={onSubmit}className="mx-autoflexmax-w-xlflex-colgap-3rounded-2xlborderborder-lightGreybg-warmWhitep-4sm:flex-rowsm:items-centersm:p-5"noValidate><labelhtmlFor="email"className="sr-only">Emailaddress</label><inputid="email"name="email"type="email"inputMode="email"autoComplete="email"requiredplaceholder="you@example.com"value={email}onChange={(e)=>setEmail(e.target.value)}className="flex-1rounded-lgborderborder-lightGreybg-whitepx-3py-2text-smtext-deepCharcoalplaceholder:text-[color:var(--color-on-secondary)/0.5]focus:border-deepCharcoalfocus:outline-none"aria-describedby="newsletter-status"/><buttontype="submit"disabled={status.state==="loading"}className="rounded-fullbg-forestpx-5py-2text-smfont-semiboldtext-creamtransitionhover:bg-[color:var(--color-primary)/0.9]disabled:cursor-not-alloweddisabled:opacity-60">{status.state==="loading"?"Subscribing…":"Subscribe"}</button></form>{(status.state==="success"||status.state==="error")&&(<pid="newsletter-status"role="status"aria-live="polite"className={status.state==="success"?"mt-3text-smtext-forest":"mt-3text-smtext-red-600"}>{message}</p>)}</div></section></Layout>);}
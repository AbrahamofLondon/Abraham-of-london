//pages/rss.xml.tsimporttype{GetServerSideProps}from "next";export constgetServerSideProps:GetServerSideProps=async({res})=>{constORIGIN=process.env.NEXT_PUBLIC_SITE_URL||"https://www.abrahamoflondon.org";constSITE_NAME="AbrahamofLondon";constDESC="FeaturedinsightsbyAbrahamofLondon—fatherhood,enterprise,society.";//ðŸ‘‡server-onlyimport(pullsinfs)—safehereconst{getAllPosts}=awaitimport("@/lib/mdx");constposts=getAllPosts().map((p:any)=>({slug:p.slug,title:p.title,excerpt:p.excerpt??"",date:p.date??null,})).sort((a,b)=>(b.date?Date.parse(b.date):0)-(a.date?Date.parse(a.date):0));constitems=posts.map((p)=>`<item><title><![CDATA[${p.title}]]></title><link>${ORIGIN}/blog/${p.slug}</link><guid>${ORIGIN}/blog/${p.slug}</guid>${p.date?`<pubDate>${newDate(p.date).toUTCString()}</pubDate>`:""}<description><![CDATA[${p.excerpt}]]></description></item>`).join("\n");constrss=`<?xmlversion="1.0"encoding="UTF-8"?><rssversion="2.0"><channel><title><![CDATA[${SITE_NAME}]]></title><link>${ORIGIN}</link><description><![CDATA[${DESC}]]></description>${items}</channel></rss>`;res.setHeader("Content-Type","application/rss+xml;charset=utf-8");res.setHeader("Cache-Control","public,max-age=3600,stale-while-revalidate=86400");res.write(rss);res.end();return{props:{}};};export defaultfunctionRSS(){returnnull;}

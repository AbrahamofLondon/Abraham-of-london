import Linkfrom"next/link";import clsxfrom"clsx";import Reactfrom"react";type Props={slug:string;title:string;date:string;//ISO."YYYY-MM-DD"allowedforall-dayevents.location?:string;description?:string|null;/**Optionaltagsfromfrontmatter(e.g.,["leadership","chatham"])*/tags?:string[]|null;/**Forcethebadgewithouttags(fallbackswitch)*/chatham?:boolean;className?:string;prefetch?:boolean;timeZone?:string;//defaultsto'Europe/London'};//----Helpers----function isDateOnly(isoish:string):boolean{return/^\d{4}-\d{2}-\d{2}$/.test(isoish);}function isValidDate(d:Date){return!Number.isNaN(d.valueOf());}function getLocalHM(dt:Date,tz:string):{hh:number;mm:number}{consthh=Number(newIntl.DateTimeFormat("en-GB",{timeZone:tz,hour:"2-digit",hour12:false}).format(dt));constmm=Number(newIntl.DateTimeFormat("en-GB",{timeZone:tz,minute:"2-digit"}).format(dt));return{hh,mm};}function formatNiceDate(iso:string,tz="Europe/London"){//Ifit'sdate-only(YYYY-MM-DD),renderthecalendardayonlyif(isDateOnly(iso)){const[y,m,d]=iso.split("-").map(Number);constdt=newDate(Date.UTC(y,m-1,d));//stableUTCsonodriftif(!isValidDate(dt))returniso;returnnewIntl.DateTimeFormat("en-GB",{timeZone:"UTC",day:"2-digit",month:"short",year:"numeric",}).format(dt);}//Otherwise,treatasfullISOandformatintargetTZconstdt=newDate(iso);if(!isValidDate(dt))returniso;constdateStr=newIntl.DateTimeFormat("en-GB",{timeZone:tz,day:"2-digit",month:"short",year:"numeric",}).format(dt);const{hh,mm}=getLocalHM(dt,tz);//Suppressmidnighttimes(00:00local)if(hh===0&&mm===0)returndateStr;consttimeStr=newIntl.DateTimeFormat("en-GB",{timeZone:tz,hour:"2-digit",minute:"2-digit",hour12:false,}).format(dt);return`${dateStr},${timeStr}`;}function toMachineDate(iso:string){//For<timedateTime>,both"YYYY-MM-DD"andfullISOarevalid.returniso;}export defaultfunctionEventCard({slug,title,date,location,description,tags=null,chatham,className,prefetch=false,timeZone="Europe/London",}:Props){constnice=formatNiceDate(date,timeZone);constmachine=toMachineDate(date);consthasLocation=Boolean(location&&location.trim());consttitleI d=React.useId();constisChatham=Boolean(chatham)||(Array.isArray(tags)&&tags.some((t)=>String(t).toLowerCase()==="chatham"));return(<article className={clsx("relativerounded-2xlborderborder-lightGreybg-whitep-6shadow-cardtransitionhover:shadow-cardHover",className)}aria-labelledby={titleId}itemScopeitemType="https://schema.org/Event">{/*Subtlebadge(onlywhentagged)*/}{isChatham&&(<span className="absoluteright-3top-3rounded-fullbg-[color:var(--color-on-secondary)/0.9]px-2py-0.5text-[10px]font-semibolduppercasetracking-widetext-cream"title="ChathamRoom(offtherecord)"aria-label="ChathamRoom(offtherecord)">Chatham</span>)}<div className="mb-2flexflex-wrapitems-centergap-2text-smtext-gray-600"><timedateTime={machine}className="rounded-fullbg-warmWhitepx-2py-0.5text-[color:var(--color-on-secondary)/0.8]"itemProp="startDate">{nice}</time>{hasLocation&&(<><span aria-hidden="true">Ãƒâ€šÃ‚·</span><span className="rounded-fullbg-warmWhitepx-2py-0.5text-[color:var(--color-on-secondary)/0.8]"itemProp="location">{location}</span></>)}</div><h3i d={titleId}className="text-lgfont-semiboldleading-snugtext-gray-900"itemProp="name"><Link href={`/events/${slug}`}className="outline-nonetransition-colorshover:text-forestfocus-visible:roundedfocus-visible:ring-2focus-visible:ring-[color:var(--color-primary)/0.3]"prefetch={prefetch}>{title}</Link></h3>{description&&(<p className="mt-2line-clamp-3text-smleading-relaxedtext-gray-700"itemProp="description">{description}</p>)}<div className="mt-4"><Link href={`/events/${slug}`}className="inline-flexitems-centerrounded-fullborderborder-[color:var(--color-primary)/0.2]px-3py-1.5text-smfont-mediumtext-foresttransition-colorshover:bg-foresthover:text-cream"prefetch={prefetch}aria-labelledby={titleId}>Details</Link></div>{/*OptionalcanonicalURLformicrodata*/}<metaitemProp="url"content={`/events/${slug}`}/></article>);}
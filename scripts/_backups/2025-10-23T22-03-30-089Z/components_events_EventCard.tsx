//components/events/EventCard.tsx"useclient";import * as React from "react";import Imagefrom"next/image";import Linkfrom"next/link";import clsxfrom"clsx";/**──────────────────────────────────────────────────────────────────────────*EventCard-UPGRADED*-EncapsulatedTag/ResourcePills*-EnhancedAccessibilityforResources*-Consolidatedlogicandimproveddatehandling*──────────────────────────────────────────────────────────────────────────*///---type Definitions---type ResItem={href:string;label:string};type Resources={downloads?:ResItem[];reads?:ResItem[]};type Props={slug:string;title:string;date:string;location?:string;description?:string;tags?:string[];heroImage?:string;resources?:Resources|null;};//NEW:explicittypessoTSknowsleft/rightareallowedtypeHeroFit="cover"|"contain";type HeroPosition="top"|"center"|"left"|"right";type Overrides={heroFit?:HeroFit;heroAspect?:"3/1"|"21/9"|"16/9"|"2/3"|"1/1";heroPosition?:HeroPosition;};//---Constants&Utilities---constDEFAULT_EVENT_IMAGE="/assets/images/events/default.jpg";constFALLBACK_CANDIDATES=[DEFAULT_EVENT_IMAGE]asconst;//NormalizesastringslugforcomparisonandURLgenerationconstnormalizeSlug=(s:string)=>s.toLowerCase().replace(/[^a-z0-9-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");//HelpertoensurerelativeURLsstartwithaslashfunctionnormalizeLocal(src?:string|null):string|undefined{if(!src)returnundefined;if(/^https?:\/\//i.test(src))returnundefined;returnsrc.startsWith("/")?src:`/${src.replace(/^\/+/,"")}`;}//Per-eventvisualoverrides(aspect/fit/position)constHERO_OVERRIDES:Record<string,Overrides>={'leadership-workshop':{heroFit:"contain",heroAspect:"3/1",heroPosition:"top"},'founders-salon':{heroFit:"contain",heroAspect:"16/9",heroPosition:"center"},//addmoreslugshere...};//UtilitytogeneratetheorderedlistofcandidateimageURLsfunctiongenerateImageCandidates(slug:string,heroImage?:string):string[]{constbase=normalizeSlug(slug);constcandidates=[normalizeLocal(heroImage),//1.Primaryimagefromfrontmatter`/assets/images/events/${base}.webp`,//2.Slug-basedfallbacks`/assets/images/events/${base}.jpg`,`/assets/images/events/${base}.jpeg`,`/assets/images/events/${base}.png`,...FALLBACK_CANDIDATES,//3.Absolutedefaultfallback].filter(Boolean)asstring[];//FilteroutduplicatesreturnArray.from(newSet(candidates));}//HelpertodetermineTailwindaspectratioclassfunctionaspectClass(key?:Overrides["heroAspect"]){switch(key){case"3/1":return"aspect-[3/1]";case"21/9":return"aspect-[21/9]";case"16/9":return"aspect-[16/9]";case"2/3":return"aspect-[2/3]";case"1/1":return"aspect-[1/1]";default:return"aspect-[16/10]";//Defaultifnooverride/invalidkey}}//---Sub-Components---//EncapsulatesthetagandresourcepilllogicandstylingconstTagPill=React.memo(({label,isLink,href}:{label:string;isLink?:boolean;href?:string})=>{constisResource=!!href;if(href?.includes(".pdf")){icon="D:";//Document}elseif(href?.includes("article")||href?.includes("read")){icon="R:";//Readingmaterial}else{icon="L:";//Genericlink}constbaseClasses="rounded-fullpx-2py-0.5text-xsfont-mediumtransition-colorsduration-200";constcontent=(<span className={clsx(baseClasses,//Tagstyling!isResource&&"borderborder-lightGreybg-warmWhitetext-[color:var(--color-on-secondary)]/[0.8]",//ResourcestylingisResource&&"borderborder-[color:var(--color-primary)]/[0.2]bg-[color:var(--color-primary)]/[0.05]text-[color:var(--color-primary)]hover:bg-[color:var(--color-primary)]/[0.1]")}>{icon}{label}</span>);//Ifit'saresource(link),returnafunctionalanchortagforaccessibilityif(isLink&&href){return(<a href={href}target="_blank"rel="noopenernoreferrer"className="inline-flex">{content}</a>);}//Ifit'sjustadescriptivetag,returnthespanreturncontent;});TagPill.displayName="TagPill";//---MainComponent---export defaultfunctionEventCard({slug,title,date,location,description,tags,heroImage,resources,}:Props){constnormalizedSlug=normalizeSlug(slug);constov=HERO_OVERRIDES[normalizedSlug];//---ImageFallbackLogic---constcandidates=React.useMemo(()=>generateImageCandidates(slug,heroImage),[slug,heroImage]);const[idx,setIdx]=React.useState(0);constcurrentHeroSrc=candidates[idx];const onHeroError=React.useCallback(()=>{//Advancetothenextcandidateifavailableif(idx+1<candidates.length){setIdx((i)=>i+1);}},[candidates.length,idx]);//---Formatting&DateHandling(UPGRADE)---constdt=React.useMemo(()=>(date?newDate(date):null),[date]);constisValidDate=dt&&!Number.isNaN(+dt);constdateLabel=isValidDate//✅UPGRADE:Used`Intl.DateTimeFormat`withaconsistentoptionsobject?newIntl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:"numeric"}).format(dt!):date;constallPills=React.useMemo(()=>{constdownloads=resources?.downloads||[];constreads=resources?.reads||[];//Combineandlimitresourcestomax4total(2downloads+2reads)return[...downloads.slice(0,2),...reads.slice(0,2)];},[resources]);//---DynamicClassGeneration---constimageClasses=clsx("transition-transformduration-300group-hover:scale-[1.02]",(ov?.heroFit??"cover")==="contain"?"object-contain":"object-cover",{"object-top":ov?.heroPosition==="top","object-left":ov?.heroPosition==="left","object-right":ov?.heroPosition==="right","object-center":ov?.heroPosition==="center"||!ov?.heroPosition,});constframeClasses=clsx("relativew-fulloverflow-hiddenrounded-t-2xl",aspectClass(ov?.heroAspect),//Ensurepadding/backgroundforcontainfitormissingimage((ov?.heroFit??"cover")==="contain"||!currentHeroSrc)&&"bg-warmWhitep-2");//Fallbackinitialsfortheimagecontainerifallsourcesfailconstinitials=React.useMemo(()=>{constwords=String(title||"").trim().split(/\s+/).slice(0,3);returnwords.map((w)=>w[0]?.toUpperCase()||"").join("")||"E•V";},[title]);constdetailHref=`/events/${encodeURIComponent(slug)}`;//ConsolidatedTailwindopacityvariablesconsttextSecondaryLight="text-[color:var(--color-on-secondary)]/[0.7]";consttextSecondaryNormal="text-[color:var(--color-on-secondary)]/[0.85]";return(<article className="grouprounded-2xlborderborder-lightGreybg-whiteshadow-cardtransitionhover:shadow-cardHover"><Link href={detailHref}prefetch={false}className="block"aria-label={`Vieweventdetailsfor:${title}`}>{/*Heroimagecontainer*/}<div className={frameClasses}>{currentHeroSrc?(<Image src={currentHeroSrc}alt={title?`${title}eventillustration`:"Eventillustration"}fill sizes="(max-width:768px)100vw,33vw"className={imageClasses}onError={onHeroError}priority={false}placeholder="blur"//AddplaceholderforbetterloadingUXblurDataURL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0EQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="/>):(//Gracefulplaceholderwhenallimagecandidatesfail<div className="absoluteinset-0flexitems-centerjustify-centerbg-gradient-to-brfrom-[color:var(--color-primary)]/[0.1]to-[color:var(--color-on-secondary)]/[0.1]"><span className={clsx("select-nonefont-seriftext-4xlfont-semibold",textSecondaryLight)}>{initials}</span></div>)}</div><div className="p-5"><h3 className="font-seriftext-xlfont-semiboldtext-deepCharcoal">{title}</h3>{/*DateandLocation*/}<div className={clsx("mt-1text-sm",textSecondaryLight)}><span>{dateLabel}</span>{location&&<span className="ml-2">•{location}</span>}</div>{/*Description*/}{description&&<p className={clsx("mt-3text-smline-clamp-3",textSecondaryNormal)}>{description}</p>}{/*Resourcepills(UPGRADE:usesTagPillcomponent)*/}{allPills.length>0&&(<div className="mt-4flexflex-wrapgap-2">{allPills.map((item,index)=>(<TagPillkey={`${item.href}-${index}`}label={item.label}isLink={true}href={item.href}/>))}</div>)}{/*Tags(UPGRADE:usesTagPillcomponent)*/}{Array.isArray(tags)&&tags.length>0&&(<div className="mt-3flexflex-wrapgap-1">{tags.slice(0,3).map((t,i)=>(<TagPillkey={`${t}-${i}`}label={t}/>))}</div>)}</div></Link></article>);}ontainerifallsourcesfailconstinitials=React.useMemo(()=>{constwords=String(title||"").trim().split(/\s+/).slice(0,3);returnwords.map((w)=>w[0]?.toUpperCase()||"").join("")||"E•V";},[title]);constdetailHref=`/events/${encodeURIComponent(slug)}`;//ConsolidatedTailwindopacityvariablesconsttextSecondaryLight="text-[color:var(--color-on-secondary)]/[0.7]";consttextSecondaryNormal="text-[color:var(--color-on-secondary)]/[0.85]";return(<article className="grouprounded-2xlborderborder-lightGreybg-whiteshadow-cardtransitionhover:shadow-cardHover"><Link href={detailHref}prefetch={false}className="block"aria-label={`Vieweventdetailsfor:${title}`}>{/*Heroimagecontainer*/}<div className={frameClasses}>{currentHeroSrc?(<Image src={currentHeroSrc}alt={title?`${title}eventillustration`:"Eventillustration"}fill sizes="(max-width:768px)100vw,33vw"className={imageClasses}onError={onHeroError}priority={false}placeholder="blur"//AddplaceholderforbetterloadingUXblurDataURL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0EQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="/>):(//Gracefulplaceholderwhenallimagecandidatesfail<div className="absoluteinset-0flexitems-centerjustify-centerbg-gradient-to-brfrom-[color:var(--color-primary)]/[0.1]to-[color:var(--color-on-secondary)]/[0.1]"><span className={clsx("select-nonefont-seriftext-4xlfont-semibold",textSecondaryLight)}>{initials}</span></div>)}</div><div className="p-5"><h3 className="font-seriftext-xlfont-semiboldtext-deepCharcoal">{title}</h3>{/*DateandLocation*/}<div className={clsx("mt-1text-sm",textSecondaryLight)}><span>{dateLabel}</span>{location&&<span className="ml-2">•{location}</span>}</div>{/*Description*/}{description&&<p className={clsx("mt-3text-smline-clamp-3",textSecondaryNormal)}>{description}</p>}{/*Resourcepills(UPGRADE:usesTagPillcomponent)*/}{allPills.length>0&&(<div className="mt-4flexflex-wrapgap-2">{allPills.map((item,index)=>(<TagPillkey={`${item.href}-${index}`}label={item.label}isLink={true}href={item.href}/>))}</div>)}{/*Tags(UPGRADE:usesTagPillcomponent)*/}{Array.isArray(tags)&&tags.length>0&&(<div className="mt-3flexflex-wrapgap-1">{tags.slice(0,3).map((t,i)=>(<TagPillkey={`${t}-${i}`}label={t}/>))}</div>)}</div></Link></article>);}
